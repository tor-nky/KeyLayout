# Windows で薙刀式v13完成版 を使うスクリプト

薙刀式を Autohotkey に実装しました。

* Naginata.ahk

IME.ahk、init.ahk、KanaTable.ahk の計４ファイルを同じディレクトリに入れておきます。

Autohotkey をインストールし、Naginata.ahk のスクリプトを実行してください。

Ahk2Exe.exe でコンパイルする場合は、Unicode版で出力してください。

## IME の設定

旧MS-IME では初期状態の設定のままでも使えますが、キー設定を行うことをおすすめします。

半角+全角	→	[入力/変換文字なし]IMEオフ, [他]半英固定

ATOK の場合はソースコードにあるコメントをご覧ください。

### 動作確認

* Windows 10 Home version 20H2 + AutoHotkey (v1.1.33.02) + 旧MS-IME あるいは ATOK 2017

## 不具合

* スペース、濁点、半濁点、拗音、編集モード などが入りっぱなしになることがある。

Windows と Autohotkey とのやり取りに失敗し、キーが上がりっぱなしと誤認されることが時々あるようです。

Escキーを押すとリセットになります。
そのとき押しているキーは無効になるので、上げてください。

* 記号を入力中に、画面がチラチラする

一部の記号を入力する際に、「n」→改行→BS を高速で入力しているためです。

* 新MS-IME で、未変換のかながある時に、記号入力が正しく行えない。さらに、かな入力が行えなくなることも多々ある。

新MS-IME 自体の不具合です。
KanaTable.ahk の修正だけでは完全に解消できませんので、とりあえず 旧MS-IME を使用しましょう。

## KanaTable.ahk で使えるキーや記号の書き方

Autohotkey の書き方がほとんどです。
(http://ahkwiki.net/Send) の特殊キー名一覧もご覧ください。

そのまま入力	0〜9 A〜Z -^@[]./ ユニコード文字

{Enter} {Esc} {Space} {Tab} {BS} {Del} {Ins}
{Up} {Down} {Left} {Right}
{Home} {End} {PgUp} {PgDn}
など

{確定}	ユニコード文字の直後に置いて確定文字にします

## 参考

* [【薙刀式】v13完成版、発表。](http://oookaworks.seesaa.net/article/479173898.html#gsc.tab=0)

## おもな修正履歴

* (Naginata.ahk) 例えば「う」押す→「スペース」押す→「う」離す、でスペースが発行されていたのを修正（大岡様ありがとうございました）
* (Naginata.ahk) 3キー以上を限りなく同時に押すと、2文字までしか入力されないことがある、のを修正

(ここまで2021年2月9日追加)

* (KanaTable.ahk) エクスプローラーの検索欄で入力が失敗する、３文字のローマ字のディレイを設定し直した

(ここまで2021年2月10日追加)

* (Naginata.ahk) リセット機能を強化
* (init.ahk) {確定}機能を実装。「n」→改行→BS を入力しています。
* (KanaTable.ahk) 記号入力で改行されすぎる不具合の解消

(ここまで2021年2月11日追加)

* (Naginata.ahk) リセット機能の不完全な実装を解消
* (KanaTable.ahk) 何も出力しない「Q」単打の「出力」を、Windows が無反応だった頃の「かな」キーのスキャンコードに変更

(ここまで2021年2月12日追加)
