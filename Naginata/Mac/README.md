# Mac を 薙刀式 v13完成版（仮） にするスクプリト

* 薙刀式.json

Windows版、QMK版の薙刀式は、押したキーをどれか離すと計算がおこなわれ、画面に出力されます。

ですが、Mac の Karabier-Elements ではキーを離したときに出力されるものは、押されたときに決まってしまい、後で変えられません。

そこで、何でもキーを押した瞬間に出力し、もう１、２個キーを同時押ししたら、その都度戻って出し直す方法を使うようにしました。

## 使用方法

JISキーボードにもUSキーボードにも対応しています。

Karabiner-Elements で英語系の配列より上に登録してください。
英語系の配列は、同時には使用できません。

### 【重要】かわせみ2 でのみ動作します。

入力方法にローマ字入力を使うように設定してください。

macOS Mojave (10.14.6) + Karabiner-Elements (v12.10.0) + かわせみ2 (2.0.17) でテスト継続中です。

## シフト方式

スペースキー、シフトキーのどちらもシフトとして操作できます。

# 未実装

* 固定名詞ショートカット

いまのところ、Office 365 版の Excel で、全部のスクリプトを生成させるように作っていますので、
完成したら、そのワークシートとともに公開します。

# 問題点

すでに分かっている問題点を書き出します。
テストが不十分なため、ほかにもたくさんあるとは思いますが、ご了承ください。

## 片手のロールオーバー入力はできますが、両手にまたがるものは、まずできません。

* できるもの

だが（Fを押しながらN→J）

しゃしゅ（Rを押しながらH→P）

* できないもの（Windows版、QMK版はできると思いますが、未確認です）

あること（J→I→V→D全部押し終わるまでどのキーも離さない）　※「あるど」となります

ないこと（M→K→V→D全部押し終わるまでどのキーも離さない）　※ M+V の同時押しになった瞬間、エンターが押されます

## ページ移動でページの先頭に行かない

その方法があるかどうかも分かりません。

## 何でもキーを押した瞬間に出力してしまうので、選択範囲を削除することが起こる。

右側の編集モードで起きるので、D+F、または C+V を同時押ししてから右側のキーを押せば発生しません。


## かな変換中に V+M の改行が２回押したのと同じ状態になる

V+M の同時押しをすれば誤動作しないようにしました。

その代わり、どちらのキーも離してから次の操作をしましょう。

# 修正

* 「リドゥ」を Mac用に直しました。

* かな入力、英数入力共通の部分をまとめてコードを小さくしました。

* D+F、C+V、V+M の同時押し（シンクロ）を判定に加えました。

(ここまで2020年10月25日)
