# Mac を 薙刀式 v13完成版（仮） にするスクプリト

* 薙刀式.json

Windows版、QMK版の薙刀式は、押したキーをどれか離すと計算がおこなわれ、画面に出力されます。

ですが、Mac の Karabier-Elements ではキーを押したときに、離したときの動作が決まってしまい、後で変えられません。

そこで、キーを何でも押した瞬間に出力し、もう１、２個キーを同時押ししたら、その都度戻って出し直す方法を使うようにしました。

## 使用方法

JISキーボードにもUSキーボードにも対応しています。

Karabiner-Elements で英語系の配列より上に登録してください。
英語系の配列は、同時には使用できません。

### 【重要】かわせみ2 でのみ動作します。

入力方法にローマ字入力を使うように設定してください。

macOS Mojave (10.14.6) + Karabiner-Elements (v12.10.0) + かわせみ2 (2.0.17) でテスト継続中です。

## シフト方式

スペースキー、シフトキーのどちらもシフトとして操作できます。

## 固定名詞ショートカット

一緒に公開した Excel のワークシートで、「固定名詞」タブ内に書き込んで、次の方法でスクリプトを作成し直して、入れ換えの登録をおこなってください。

1. Excel の左上の「A4」とか書いてある部分の矢印をクリックする
2. 「スクリプトA」を選ぶ
3. Command + C でコピーする
4. テキストエディットで新規書類を作り、「フォーマット」から「標準テキストにする」としてからペーストする。
5. Excel の左上の「A4」とか書いてある部分の矢印をクリックする
6. 「スクリプトB」を選ぶ
7. Command + C でコピーする
8. テキストエディットの先ほどの続きにペーストする
9. 「薙刀式.json」などのファイル名でフォルダ ~/.config/karabiner/assets/complex_modifications/ に保存する
10. Karabiner-Elements で古い登録を削除して、今度作ったものを再登録する

ただし、ワークシートは Office 365版でしか動かすことができません。ネット上で動作する Office 無料版で動くかは未確認です。

とりあえず１個所あたり１０文字までとしました。登録の直後（Mac を再起動するまでか？）、１０文字の入力に約３秒かかったので。

# 問題点

すでに分かっている問題点を書き出します。
テストが不十分なため、ほかにもたくさんあるとは思いますが、ご了承ください。

### 右手側のロールオーバー入力はすべてできます。両手にまたがるものは、まずできません。

### ページ移動でページの先頭に行かない

その方法があるかどうかも分かりません。

### 何でもキーを押した瞬間に出力してしまうので、選択範囲を削除することが起こる。

右側の編集モードで起きるので、D+F、または C+V を同時押ししてから右側のキーを押せば発生しません。

### かな変換中に V+M の改行が２回押したのと同じ状態になる

V+M の同時押しをしてください。

その代わり、次の操作の前にどちらのキーも離しましょう。

### Excel のワークシートは複雑になりすぎ、しかも Mac版Excel で「あ」と「ぁ」などの小書き文字の区別がつかないので、手動設定でしのいでいる

いずれ大改造するかもしれません。

# 修正履歴

* 「リドゥ」を Mac用に直しました。

* かな入力、英数入力共通の部分をまとめてコードを小さくしました。

* D+F、C+V、V+M の同時押し（シンクロ）を判定に加えました。

(ここまで2020年10月25日)

* 英数入力全般で SandS が働くようにした。

* ローマ字テープルを調整

* 固定名詞ショートカットを実現するために、Excel のワークシートを公開

(ここまで2020年10月27日)
